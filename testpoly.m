%%Polygon coordinates 
p0  = [-0.935384, 0.507278, -0.272116];
p1  = [-0.915801, 0.536228, 0.283002];
p2  = [-0.882043, 0.099694, -0.646826];
p3  = [-0.834764, 0.169584, 0.693348];
p4  = [-0.787023, -0.447768, -0.621628];
p5  = [-0.739744, -0.377878, 0.718546];
p6  = [-0.705986, -0.814411, -0.211282];
p7  = [-0.686402, -0.785462, 0.343836];
p8  = [-0.561956, 0.553237, -0.681771];
p9 = [-0.514677, 0.623127, 0.658404];
p10 = [-0.332557, -0.768453, -0.620937];
p11 = [-0.285278, -0.698562, 0.719237];
p12 = [-0.014265, 0.647182, -0.705992];
p13 = [0.033015, 0.717073, 0.634183];
p14 = [0.215134, -0.674508, -0.645158];
p15 = [0.262413, -0.604617, 0.695016];
p16 = [0.386859, 0.734081, -0.330591];
p17 = [0.406443, 0.763031, 0.224528];
p18 = [0.440201, 0.326497, -0.705301];
p19 = [0.48748, 0.396388, 0.634874];
p20 = [0.535221, -0.220964, -0.680103];
p21 = [0.5825, -0.151074, 0.660072];
p22 = [0.616258, -0.587608, -0.269757];
p23 = [0.635842, -0.558659, 0.285361];
p24 = [0.831438, 0.541255, -0.057559];
p25 = [0.884779, 0.13367, -0.432269];
p26 = [0.912475, 0.174611, 0.352787];
p27 = [0.965816, -0.232973, -0.021924];



%% Plotting coordinates
x  = [p24(1) p16(1) p17(1)];       
y  = [p24(2) p16(2) p17(2)];
z  = [p24(3) p16(3) p17(3)];

x1  = [p26(1) p19(1) p21(1)];       
y1  = [p26(2) p19(2) p21(2)];
z1  = [p26(3) p19(3) p21(3)];

x2  = [p27(1) p23(1) p22(1)];       
y2  = [p27(2) p23(2) p22(2)];
z2  = [p27(3) p23(3) p22(3)];

x3  = [p25(1) p20(1) p18(1)];       
y3  = [p25(2) p20(2) p18(2)];
z3  = [p25(3) p20(3) p18(3)];

x4  = [p21(1) p15(1) p23(1)];       
y4  = [p21(2) p15(2) p23(2)];
z4  = [p21(3) p15(3) p23(3)];

x5  = [p5(1) p7(1) p11(1)];       
y5  = [p5(2) p7(2) p11(2)];
z5  = [p5(3) p7(3) p11(3)];

x6  = [p17(1) p13(1) p19(1)];       
y6  = [p17(2) p13(2) p19(2)];
z6  = [p17(3) p13(3) p19(3)];

x7  = [p1(1) p3(1) p9(1)];       
y7  = [p1(2) p3(2) p9(2)];
z7  = [p1(3) p3(3) p9(3)];

x8  = [p18(1) p12(1) p16(1)];       
y8  = [p18(2) p12(2) p16(2)];
z8  = [p18(3) p12(3) p16(3)];

x9  = [p2(1) p0(1) p8(1)];       
y9  = [p2(2) p0(2) p8(2)];
z9  = [p2(3) p0(3) p8(3)];

x10  = [p22(1) p14(1) p20(1)];       
y10  = [p22(2) p14(2) p20(2)];
z10  = [p22(3) p14(3) p20(3)];

x11  = [p6(1) p4(1) p10(1)];       
y11  = [p6(2) p4(2) p10(2)];
z11  = [p6(3) p4(3) p10(3)];

x12  = [p25(1) p24(1) p26(1) p27(1)];       
y12  = [p25(2) p24(2) p26(2) p27(2)];
z12  = [p25(3) p24(3) p26(3) p27(3)];

x13  = [p24(1) p25(1) p18(1) p16(1)];       
y13  = [p24(2) p25(2) p18(2) p16(2)];
z13  = [p24(3) p25(3) p18(3) p16(3)];

x14  = [p26(1) p24(1) p17(1) p19(1)];       
y14  = [p26(2) p24(2) p17(2) p19(2)];
z14  = [p26(3) p24(3) p17(3) p19(3)];

x15  = [p27(1) p26(1) p21(1) p23(1)];       
y15  = [p27(2) p26(2) p21(2) p23(2)];
z15  = [p27(3) p26(3) p21(3) p23(3)];

x16  = [p25(1) p27(1) p22(1) p20(1)];       
y16  = [p25(2) p27(2) p22(2) p20(2)];
z16  = [p25(3) p27(3) p22(3) p20(3)];

x17  = [p23(1) p15(1) p11(1) p7(1) p6(1) p10(1) p14(1) p22(1)];
y17  = [p23(2) p15(2) p11(2) p7(2) p6(2) p10(2) p14(2) p22(2)];
z17  = [p23(3) p15(3) p11(3) p7(3) p6(3) p10(3) p14(3) p22(3)];

x18  = [p20(1) p14(1) p10(1) p4(1) p2(1) p8(1) p12(1) p18(1)];
y18  = [p20(2) p14(2) p10(2) p4(2) p2(2) p8(2) p12(2) p18(2)];
z18  = [p20(3) p14(3) p10(3) p4(3) p2(3) p8(3) p12(3) p18(3)];

x19  = [p16(1) p12(1) p8(1) p0(1) p1(1) p9(1) p13(1) p17(1)];
y19  = [p16(2) p12(2) p8(2) p0(2) p1(2) p9(2) p13(2) p17(2)];
z19  = [p16(3) p12(3) p8(3) p0(3) p1(3) p9(3) p13(3) p17(3)];

x20  = [p19(1) p13(1) p9(1) p3(1) p5(1) p11(1) p15(1) p21(1)];
y20  = [p19(2) p13(2) p9(2) p3(2) p5(2) p11(2) p15(2) p21(2)];
z20  = [p19(3) p13(3) p9(3) p3(3) p5(3) p11(3) p15(3) p21(3)];
 
x21  = [p4(1) p6(1) p7(1) p5(1) p3(1) p1(1) p0(1) p2(1)];
y21  = [p4(2) p6(2) p7(2) p5(2) p3(2) p1(2) p0(2) p2(2)];
z21  = [p4(3) p6(3) p7(3) p5(3) p3(3) p1(3) p0(3) p2(3)];


%% Centroid calculation
ab = ((p4(1)+p6(1)+p7(1)+p5(1)+p3(1)+p1(1)+p0(1)+p2(1))/8); 
ac = ((p4(2)+p6(2)+p7(2)+p5(2)+p3(2)+p1(2)+p0(2)+p2(2))/8)
ad = ((p4(3)+p6(3)+p7(3)+p5(3)+p3(3)+p1(3)+p0(3)+p2(3))/8)

V0 = [ab ac ad];
V1 = [0 0 3];


%% View point
or = [0 0 0];
r1 = [or(1) V1(1)];
r2 = [or(2) V1(2)];
r3 = [or(3) V1(3)];


%% Formulation of quaternion
Qxyz = cross(V1,V0);
a2L  = sqrt(V1(1)^2+V1(2)^2+V1(3)^2);
V0L  = sqrt(V0(1)^2+V0(2)^2+V0(3)^2);

Qw   = sqrt((a2L^2)*(V0L^2))+dot(a2,V0);
q    = [Qw Qxyz];

n    = quatnormalize(q)
q1   = quaternion(n)

%% ROTATE POINTS

rt0 = rotateframe(q1,p0)
rt1 = rotateframe(q1,p1)
rt2 = rotateframe(q1,p2)
rt3 = rotateframe(q1,p3)
rt4 = rotateframe(q1,p4)
rt5 = rotateframe(q1,p5)
rt6 = rotateframe(q1,p6)
rt7 = rotateframe(q1,p7)
rt8 = rotateframe(q1,p8)
rt9 = rotateframe(q1,p9)
rt10 = rotateframe(q1,p10)
rt11 = rotateframe(q1,p11)
rt12 = rotateframe(q1,p12)
rt13 = rotateframe(q1,p13)
rt14 = rotateframe(q1,p14)
rt15 = rotateframe(q1,p15)
rt16 = rotateframe(q1,p16)
rt17 = rotateframe(q1,p17)
rt18 = rotateframe(q1,p18)
rt19 = rotateframe(q1,p19)
rt20 = rotateframe(q1,p20)
rt21 = rotateframe(q1,p21)
rt22 = rotateframe(q1,p22)
rt23 = rotateframe(q1,p23)
rt24 = rotateframe(q1,p24)
rt25 = rotateframe(q1,p25)
rt26 = rotateframe(q1,p26)
rt27 = rotateframe(q1,p27)


xa = [rt24(1) rt16(1) rt17(1)];       
ya  = [rt24(2) rt16(2) rt17(2)];
za  = [rt24(3) rt16(3) rt17(3)];

x1a  = [rt26(1) rt19(1) rt21(1)];       
y1a  = [rt26(2) rt19(2) rt21(2)];
z1a  = [rt26(3) rt19(3) rt21(3)];

x2a  = [rt27(1) rt23(1) rt22(1)];       
y2a  = [rt27(2) rt23(2) rt22(2)];
z2a  = [rt27(3) rt23(3) rt22(3)];

x3a  = [rt25(1) rt20(1) rt18(1)];       
y3a  = [rt25(2) rt20(2) rt18(2)];
z3a  = [rt25(3) rt20(3) rt18(3)];

x4a  = [rt21(1) rt15(1) rt23(1)];       
y4a  = [rt21(2) rt15(2) rt23(2)];
z4a  = [rt21(3) rt15(3) rt23(3)];

x5a  = [rt5(1) rt7(1) rt11(1)];       
y5a  = [rt5(2) rt7(2) rt11(2)];
z5a  = [rt5(3) rt7(3) rt11(3)];

x6a  = [rt17(1) rt13(1) rt19(1)];       
y6a  = [rt17(2) rt13(2) rt19(2)];
z6a  = [rt17(3) rt13(3) rt19(3)];

x7a  = [rt1(1) rt3(1) rt9(1)];       
y7a  = [rt1(2) rt3(2) rt9(2)];
z7a  = [rt1(3) rt3(3) rt9(3)];

x8a  = [rt18(1) rt12(1) rt16(1)];       
y8a  = [rt18(2) rt12(2) rt16(2)];
z8a  = [rt18(3) rt12(3) rt16(3)];

x9a  = [rt2(1) rt0(1) rt8(1)];       
y9a  = [rt2(2) rt0(2) rt8(2)];
z9a  = [rt2(3) rt0(3) rt8(3)];

x10a  = [rt22(1) rt14(1) rt20(1)];       
y10a  = [rt22(2) rt14(2) rt20(2)];
z10a  = [rt22(3) rt14(3) rt20(3)];

x11a  = [rt6(1) rt4(1) rt10(1)];       
y11a  = [rt6(2) rt4(2) rt10(2)];
z11a  = [rt6(3) rt4(3) rt10(3)];

x12a  = [rt25(1) rt24(1) rt26(1) rt27(1)];       
y12a  = [rt25(2) rt24(2) rt26(2) rt27(2)];
z12a  = [rt25(3) rt24(3) rt26(3) rt27(3)];

x13a  = [rt24(1) rt25(1) rt18(1) rt16(1)];       
y13a  = [rt24(2) rt25(2) rt18(2) rt16(2)];
z13a  = [rt24(3) rt25(3) rt18(3) rt16(3)];

x14a  = [rt26(1) rt24(1) rt17(1) rt19(1)];       
y14a  = [rt26(2) rt24(2) rt17(2) rt19(2)];
z14a  = [rt26(3) rt24(3) rt17(3) rt19(3)];

x15a  = [rt27(1) rt26(1) rt21(1) rt23(1)];       
y15a  = [rt27(2) rt26(2) rt21(2) rt23(2)];
z15a  = [rt27(3) rt26(3) rt21(3) rt23(3)];

x16a  = [rt25(1) rt27(1) rt22(1) rt20(1)];       
y16a  = [rt25(2) rt27(2) rt22(2) rt20(2)];
z16a  = [rt25(3) rt27(3) rt22(3) rt20(3)];

x17a  = [rt23(1) rt15(1) rt11(1) rt7(1) rt6(1) rt10(1) rt14(1) rt22(1)];
y17a  = [rt23(2) rt15(2) rt11(2) rt7(2) rt6(2) rt10(2) rt14(2) rt22(2)];
z17a  = [rt23(3) rt15(3) rt11(3) rt7(3) rt6(3) rt10(3) rt14(3) rt22(3)];

x18a  = [rt20(1) rt14(1) rt10(1) rt4(1) rt2(1) rt8(1) rt12(1) rt18(1)];
y18a  = [rt20(2) rt14(2) rt10(2) rt4(2) rt2(2) rt8(2) rt12(2) rt18(2)];
z18a  = [rt20(3) rt14(3) rt10(3) rt4(3) rt2(3) rt8(3) rt12(3) rt18(3)];

x19a  = [rt16(1) rt12(1) rt8(1) rt0(1) rt1(1) rt9(1) rt13(1) rt17(1)];
y19a  = [rt16(2) rt12(2) rt8(2) rt0(2) rt1(2) rt9(2) rt13(2) rt17(2)];
z19a  = [rt16(3) rt12(3) rt8(3) rt0(3) rt1(3) rt9(3) rt13(3) rt17(3)];

x20a  = [rt19(1) rt13(1) rt9(1) rt3(1) rt5(1) rt11(1) rt15(1) rt21(1)];
y20a  = [rt19(2) rt13(2) rt9(2) rt3(2) rt5(2) rt11(2) rt15(2) rt21(2)];
z20a = [rt19(3) rt13(3) rt9(3) rt3(3) rt5(3) rt11(3) rt15(3) rt21(3)];
 
x21a  = [rt4(1) rt6(1) rt7(1) rt5(1) rt3(1) rt1(1) rt0(1) rt2(1)];
y21a  = [rt4(2) rt6(2) rt7(2) rt5(2) rt3(2) rt1(2) rt0(2) rt2(2)];
z21a = [rt4(3) rt6(3) rt7(3) rt5(3) rt3(3) rt1(3) rt0(3) rt2(3)];





%% Plotting coordinates
figure
grid on 
hold all
fill3(x,y,z,1);
fill3(x1,y1,z1,2);
fill3(x2,y2,z2,3);
fill3(x3,y3,z3,4);
fill3(x4,y4,z4,5);
fill3(x5,y5,z5,6);
fill3(x6,y6,z6,7);
fill3(x7,y7,z7,8);
fill3(x8,y8,z8,9);
fill3(x9,y9,z9,10);
fill3(x10,y10,z10,11);
fill3(x11,y11,z11,12);
fill3(x12,y12,z12,13);
fill3(x13,y13,z13,14);
fill3(x14,y14,z14,15);
fill3(x15,y15,z15,16);
fill3(x16,y16,z16,17);
fill3(x17,y17,z17,18);
fill3(x18,y18,z18,19);
fill3(x19,y19,z19,20);
fill3(x20,y20,z20,21);
fill3(x21,y21,z21,22);

figure 
grid on 
hold all
plot3(r1,r2,r3)
fill3(xa,ya,za,1);
fill3(x1a,y1a,z1a,2);
fill3(x2a,y2a,z2a,3);
fill3(x3a,y3a,z3a,4);
fill3(x4a,y4a,z4a,5);
fill3(x5a,y5a,z5a,6);
fill3(x6a,y6a,z6a,7);
fill3(x7a,y7a,z7a,8);
fill3(x8a,y8a,z8a,9);
fill3(x9a,y9a,z9a,10);
fill3(x10a,y10a,z10a,11);
fill3(x11a,y11a,z11a,12);
fill3(x12a,y12a,z12a,13);
fill3(x13a,y13a,z13a,14);
fill3(x14a,y14a,z14a,15);
fill3(x15a,y15a,z15a,16);
fill3(x16a,y16a,z16a,17);
fill3(x17a,y17a,z17a,18);
fill3(x18a,y18a,z18a,19);
fill3(x19a,y19a,z19a,20);
fill3(x20a,y20a,z20a,21);
fill3(x21a,y21a,z21a,22);